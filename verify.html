<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>प्रमाण पत्र सत्यापन</title>
<style>
body { font-family: "Noto Sans Devanagari", sans-serif; text-align: center; background: #f8f8f8; padding: 30px; }
h2 { color: #0b3d91; }
.details { margin-top: 20px; font-size: 18px; }
.label { font-weight: bold; }
.error { color: red; font-weight: bold; }
</style>
</head>
<body>

<h2>प्रमाण पत्र सत्यापन</h2>
<div id="content">सत्यापन हो रहा है...</div>

<script>
const sheetAPI = "https://script.google.com/macros/s/AKfycbyXGMzsFBWYuxy84XYa8CrjHGgrMElyEIW93YUZHsn4mOjDtFl--0UuR5r6CdqJe8la/exec"; // same Apps Script URL
const params = new URLSearchParams(window.location.search);
const ref = params.get("ref");
const contentDiv = document.getElementById("content");

if(!ref){
  contentDiv.innerHTML = '<p class="error">सत्यापन के लिए कोई Reference नंबर नहीं मिला।</p>';
} else {
  fetch(sheetAPI + "?ref=" + encodeURIComponent(ref))
    .then(res=>res.json())
    .then(data=>{
      if(!data || data.length===0){
        contentDiv.innerHTML = '<p class="error">कोई प्रमाण पत्र नहीं मिला।</p>';
      } else {
        const row = data[0];
        const [name,mobile,email,qrBase64,verifyLink,timestamp] = row;
        contentDiv.innerHTML = `
          <div class="details">
            <p><span class="label">नाम:</span> ${name}</p>
            <p><span class="label">मोबाइल:</span> ${mobile}</p>
            <p><span class="label">ईमेल:</span> ${email}</p>
            <p><span class="label">Reference No.:</span> ${ref}</p>
            <p><span class="label">सत्यापन समय:</span> ${new Date(timestamp).toLocaleString('hi-IN')}</p>
            <img src="${qrBase64}" width="150">
          </div>
        `;
      }
    })
    .catch(err=>{
      console.error(err);
      contentDiv.innerHTML = '<p class="error">डेटा लाने में समस्या हुई।</p>';
    });
}
</script>
</body>
</html>
